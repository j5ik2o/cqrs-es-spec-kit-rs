---

description: "機能実装用タスクリストテンプレート"
---

# Tasks: [FEATURE NAME]

**Input**: `/specs/[###-feature-name]/` 以下の design ドキュメント  
**Prerequisites**: plan.md（必須）、spec.md（ユーザーストーリー必須）、research.md、data-model.md、contracts/

**Tests**: 以下の例に示すテストタスクは任意。仕様で明示的に要求された場合のみ含める。

**構成**: タスクはユーザーストーリー単位でグルーピングし、各ストーリーが独立して実装・テストできるようにする。

## 書式: `[ID] [P?] [Story] 説明`

- **[P]**: 並列実行可能なタスク（異なるファイルで依存がないもの）
- **[Story]**: 対応するユーザーストーリー（例: US1, US2, US3）
- 説明には正確なファイルパスを含めること

## パス規約

- **単一プロジェクト**: `src/`, `tests/` はリポジトリ直下
- **Web構成**: `backend/src/`, `frontend/src/`
- **モバイル構成**: `api/src/`, `ios/src/` または `android/src/`
- 以下のサンプルタスクは説明用。実際の `/speckit.tasks` 出力では必ず置き換えること。

<!--
  ==========================================================================
  以下のリストはサンプル。OpenSpec の tasks.md 生成時には、実際のユーザーストーリーと要件に基づくタスクに差し替えること。
  各ストーリーは単独で実装・テスト・デプロイ可能でなければならない。
  ==========================================================================
-->

## Phase 1: Setup (共有基盤)

**目的**: プロジェクト初期化と基本構造の整備

- [ ] T001 プロジェクト構成を plan.md で合意した形に整備
- [ ] T002 Rust プロジェクトと必要な依存関係を初期化
- [ ] T003 [P] Lint/フォーマッタ/CI 設定を追加

---

## Phase 2: Foundational (全ストーリーの前提)

**目的**: いずれのユーザーストーリーにも必須となる基盤を構築

**⚠️ 重要**: このフェーズ完了前にユーザーストーリーへ着手してはならない。

例:

- [ ] T004 DynamoDB ジャーナル／スナップショットテーブルと `event-store-adapter-rs` 設定を整備
- [ ] T005 [P] DynamoDB Streams→Lambda（イベントフォワーダー）→Kinesis→Lambda（リードモデル更新）→MySQL のパイプラインを構成
- [ ] T006 [P] GraphQL/BFF レイヤの認証・監査・スキーマ管理をセットアップ
- [ ] T007 共通ドメインモデル／イベント定義とリードモデル投影スキーマを追加
- [ ] T008 エラーハンドリングと構造化ログ (`tracing`) を導入
- [ ] T009 環境変数や Secrets Manager 連携、RDS Proxy 設定を整備

**チェックポイント**: 基盤準備完了。以降のストーリーを並列で進められる。

---

## Phase 3: User Story 1 - [タイトル] (Priority: P1) 🎯 MVP

**ゴール**: [このストーリーが提供する価値]

**独立テスト**: [単体で検証する方法]

### User Story 1 向けテスト (要求がある場合のみ) ⚠️

> **NOTE**: まずテストを書き、失敗を確認してから実装すること。

- [ ] T010 [P] [US1] 契約テスト `tests/contract/` を追加
- [ ] T011 [P] [US1] 結合テスト `tests/integration/` を追加

### User Story 1 実装

- [ ] T012 [P] [US1] ドメインモデルを `src/models/` に追加
- [ ] T013 [P] [US1] アプリケーションサービスを `src/services/` に実装
- [ ] T014 [US1] GraphQL Mutation や API エンドポイントを実装
- [ ] T015 [US1] バリデーションとエラーハンドリングを追加
- [ ] T016 [US1] ロギング・監査情報を追加

**チェックポイント**: User Story 1 が単独でテスト・デモ可能。

---

## Phase 4: User Story 2 - [タイトル] (Priority: P2)

**ゴール**: [提供する価値]

**独立テスト**: [検証方法]

### User Story 2 向けテスト (要求がある場合のみ) ⚠️

- [ ] T018 [P] [US2] 契約テストを追加
- [ ] T019 [P] [US2] 結合テストを追加

### User Story 2 実装

- [ ] T020 [P] [US2] モデル／投影を追加
- [ ] T021 [US2] サービス・ユースケース層を実装
- [ ] T022 [US2] GraphQL Query / Subscription を更新
- [ ] T023 [US2] User Story 1 との連携を調整（必要な場合）

**チェックポイント**: User Story 1 と 2 が互いに独立して成立。

---

## Phase 5: User Story 3 - [タイトル] (Priority: P3)

**ゴール**: [提供する価値]

**独立テスト**: [検証方法]

### User Story 3 向けテスト (要求がある場合のみ) ⚠️

- [ ] T024 [P] [US3] 契約テストを追加
- [ ] T025 [P] [US3] 結合テストを追加

### User Story 3 実装

- [ ] T026 [P] [US3] モデル／投影を追加
- [ ] T027 [US3] サービスを実装
- [ ] T028 [US3] API / UI を実装

**チェックポイント**: すべてのユーザーストーリーが独立して機能。

---

[必要に応じて追加のフェーズを追記]

---

## Phase N: Polish & Cross-Cutting Concerns

**目的**: 複数ストーリーに跨る改善

- [ ] TXXX [P] ドキュメント更新 (docs/)
- [ ] TXXX コードリファクタリングと品質向上
- [ ] TXXX パフォーマンス最適化
- [ ] TXXX [P] 追加のユニットテスト `tests/unit/`
- [ ] TXXX セキュリティ強化
- [ ] TXXX quickstart.md の手順検証

---

## 依存関係と実行順序

### フェーズ間依存

- **Setup (Phase 1)**: 依存なし。即時着手可。
- **Foundational (Phase 2)**: Setup 完了に依存。完了まで他フェーズを実施してはならない。
- **User Stories (Phase 3+)**: Foundational 完了後に開始。優先度順または並列で進行可能。
- **Polish (最終フェーズ)**: すべての対象ユーザーストーリー完了後に実施。

### ユーザーストーリー依存

- **US1 (P1)**: Foundational 完了後に開始。基本的に他ストーリーへ依存しない。
- **US2 (P2)**: Foundational 完了後に開始。US1 に連携が必要な場合は明示する。
- **US3 (P3)**: Foundational 完了後に開始。US1/US2 の成果物を再利用する場合は衝突を避けるための手順を記述する。

### ストーリー内の順序

- テスト（存在する場合）は実装前に追加し、失敗を確認する。
- モデル → サービス → エンドポイントの順で進める。
- コア実装完了後に統合・エラーハンドリング・監査を追加する。

### 並列実行の例

- [P] マークの Setup/Foundational タスクは並列実行可。
- Foundational 完了後、複数のユーザーストーリーを別メンバーが並列で進められる。
- 同一ストーリー内でも [P] マーク付きタスクは並列化できる。

---

## 実装戦略

### MVP 優先

 1. Setup → Foundational を完了
 2. User Story 1 (P1) を実装し、GraphQL/BFF 経由で独立してテスト・デモ可能にする
3. 必要に応じてデプロイ／レビュー

### 段階的デリバリー

1. Setup + Foundational 完了
2. User Story 1 → テスト → デプロイ/デモ
3. User Story 2 → テスト → デプロイ/デモ
4. User Story 3 → テスト → デプロイ/デモ
5. 各段階で価値を提供しつつ進行

### 複数人での並列開発

1. Setup + Foundational を全員で完了
2. 開発者 A: US1、開発者 B: US2、開発者 C: US3 などに割り当て
3. 進行状況を tasks.md で追跡し、全タスク完了後にチェックを付ける

---

## 備考

- [P] タスクは依存関係のない並列タスクを示す。
- 各ユーザーストーリーは独立して完結できるように構成する。
- テストは失敗を確認してから実装し、CI に組み込む。
- コミットはタスクまたは論理単位ごとに分割する。
- 憲章で定義されたイベントソーシング、CQRS、サンドボックス運用、OpenSpec 同期を常に確認すること。
